# JELILIAN AI PRO Supervisor配置文件
# 用于进程管理和自动重启

[program:jelilian-ai-pro]
# 启动命令
command=/opt/jelilian-ai-pro/venv/bin/gunicorn -c /opt/jelilian-ai-pro/deploy/gunicorn_config.py web_launcher:app

# 工作目录
directory=/opt/jelilian-ai-pro

# 运行用户
user=www-data

# 自动启动和重启
autostart=true
autorestart=true

# 启动重试
startretries=3
startsecs=10

# 日志配置
redirect_stderr=true
stdout_logfile=/var/log/jelilian-ai-pro.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
stdout_capture_maxbytes=1MB
stdout_events_enabled=false

# 环境变量
environment=PATH="/opt/jelilian-ai-pro/venv/bin",
           PYTHONPATH="/opt/jelilian-ai-pro",
           ENVIRONMENT="production"

# 进程优先级
priority=999

# 停止信号
stopsignal=TERM
stopwaitsecs=10

# 进程组
process_name=%(program_name)s_%(process_num)02d
numprocs=1

# 如果需要多进程，可以调整numprocs
# numprocs=4  # 根据服务器CPU核心数调整